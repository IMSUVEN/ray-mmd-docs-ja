# 4.クイックスタート

MMDを起動した状態(新規作成)からの説明です。最低限の設定（下準備）ですので、マテリアルやライト等追加の設定が必要になってきますが、それらは各章の説明を参照してください。

1. ray.xを追加する  
    ray.xをMMDにドラッグアンドドロップで追加します。

    ![4_1_1](images/4_1_1.png "ray.xをドラッグ・アンド・ドロップ")
    
    少し時間がかかります。場合（OS?）によっては黒背景になります。  

    ![4_1_2](images/4_1_2.png "ray.xを追加した後")

2. アンチエイリアスをオフにする  
    MMDの「表示」メニューからアンチエイリアスをオフにします。  
    1.で変わった黒背景が白背景にもどりました。  
    ※アンチエイリアスはray-mmdのものが使用されます。

    ![4_2_1](images/4_2_1.png "アンチエイリアスをオフに")

3. スカイボックスを追加する  
    Skyboxフォルダの中から、任意のスカイボックスを追加します。詳細については「7. スカイボックス」を参照してください。  
    　ここでは、「Helipad GoldenHour」を追加してみます。

    1. 「Skybox\Helipad GoldenHour」フォルダを開き`Sky with box.pmx`をMMDに追加します。

        ![4_3_1](images/4_3_1.png "Sky with box.pmx を追加")

    2. MMDの「モデル描画順」で一番上に。(これはスカイボックス共通の操作)

        ![4_3_2](images/4_3_2.png "Skyboxを「モデル描画順」で一番上に")

    3. `Sky with lighting.fx`を「EnvLightMap」でスカイボックスに割り当てます。（デフォルトでは`skylighting_none.fx`が割り当てられています。）

        ![4_3_3](images/4_3_3.png "「EnvLightMap」に割り当て")

    ※ 割り当てるfxは必ず同じフォルダのものを割り当てて下さい。別フォルダのものを割り当てると、Skyboxからのライティングが正しいものになりません。

4. モデルを追加する  
    MMDに任意のキャラクター、ステージを追加し、MMEの「Main」タブでモデルを選択して`main\main.fx` を割り当てます。  
    ※　複数のモデルを選択する場合、ShiftキーやCtrlキーが利用できます。

    ![4_4_1](images/4_4_1.png "「Main」タブにて `main\main.fx` を割り当て")

    　「Main」タブに`main\main.fx` を割り当てると、「MaterialMap」タブに `Materials\material_2.0.fx` がデフォルトマテリアルとして割り当てられます。  
    　マテリアルの設定は、「MaterialMap」にマテリアルのfxを割り当てることによって行います。

    * 注意：  
    拡張子 `.x` ファイルのもの（アクセサリやステージなど）は対応していません。PMXへ変換する場合は、規約を確認してから行いましょう。

5. ray_controller.pmxを追加する  
    `ray_controller.pmx`をMMDにドラッグアンドドロップで追加します。  

    ![4_5_1](images/4_5_1.png "ray_controller.pmxをMMDに追加")

    このコントローラーを使う事により、ライトやSSAO、ブルーム、色調等の調整ができます。

6. ここまでで必要最低限の設定が完了です。  
    必要に応じてマテリアル、ライト、エフェクト等の追加を行いますが、これらについては各項目の説明を参照してください。

    此処までの結果にメインライトの調整を行ったもの。
    ![4_6_1](images/4_6_1.png "此処までの結果")

* ### 描画順について
    　追加の順番はこの説明の順番通りでなくてもかまいません。  
    先にモデルやモーションなどをセットアップした後にray-mmdを追加した場合、「モデルの描画順」でスカイボックスのpmxが一番上、「アクセサリ編集」で`ray.x`が一番上になるように再設定すれば問題ありません。  

* ### 表示が上手く行かない場合
    大抵の場合、割り当てるfxとタブを間違えている事が多いです。慌てずしっかり確認してみましょう。間違った設定を正しく設定し直した後、「MMEffect」メニューから「全て更新」が必要な時もあります。

    * ライトに照らされていない場所が真っ黒になる。  
        Skyboxの「EnvLightMap」タブへの設定し忘れ。
    ![4_7_1](images/NoSkyLighting.png "EnvLightMapタブへの設定し忘れ")

    * 表示が緑や紫になる。  
        マテリアルのfxやskyboxのライティング用のfxを「Main」タブに割り当ててしまった場合。割と多い事例だと思います。  
        下の図は`Sky with lighting.fx`を「Main」タブに設定してしまった例。この場合は一度Skyboxを削除し、再度追加の手順を行ったほうが早いと思います。
    ![4_7_1](images/SkyLighting2Main.png "Sky with lighting.fxを「Main」タブに設定")

-----

<small> Model : Hatsune Miku V4X Model by Digitrevx / 屋上風ステージ by KTY</small>

