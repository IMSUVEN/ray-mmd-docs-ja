# 8.マテリアル

## 8-1.マテリアル概要

マテリアルとは、モデルの見た目を決定する設定です。MMDのモデルでは「材質」と呼ばれている設定ですが、ray-mmdでは従来のMMDモデルの設定とは異なり、PBR(Physically Based Rendering - 物理ベースレンダリング)用のマテリアル設定を行うことになります。  

その為、MMDのモデルにray-mmdのデフォルトマテリアル(`material_2.0.fx`)を設定すると、多くの場合、白っぽい感じになりMMD標準のレンダリング結果との差を感じることになると思います。これは、ray-mmdがMMDの材質設定に合わせたレンダラーではなく、PBRのマテリアル設定に合わせたレンダラーだからです。  

PBRのマテリアル設定、特にアルベドで参照されるテクスチャマップの色の設定方法が従来のものと大きく異なり、輝度で言うと非金属の場合sRGBで30～240程度に収まり完全な白(255)や黒(0)は使われません。

ray-mmdのマテリアルは、モデルの材質設定の一部を参照しつつ、足りないパラメータについてはマテリアル設定のfxファイルで補う形になっています。デフォルトマテリアルの `material_2.0.fx` をコピーして編集することで、独自のマテリアルファイルを作成することが出来ます。

PBRのマテリアル詳細については下記の参考資料を参照してください。

* 参考資料
    * [物理ベースレンダリング -基礎編-](http://tech.cygames.co.jp/archives/2339/)  
    * [『THE COMPREHENSIVE PBR GUIDE Volume 1: The Theory of PBR by Allegorithmic』 私家訳版](https://www.slideshare.net/nyaakobayashi/pbr-guide-vol1jp)  
    * [『THE COMPREHENSIVE PBR GUIDE – Vol. 2: Practical guidelines for creating PBR textures 』 私家訳版](https://www.slideshare.net/nyaakobayashi/70100srgb180255)
    * [Remember Me の物理ベースレンダリング (GDC Europe 2013)の説明](http://d.hatena.ne.jp/hanecci/20130913/p1) の後半部分


<!---
* MMDモデルのマテリアルとray-mmdのマテリアルの比較  
    下記の表を見てわかるように、MMDモデルのマテリアルとray-mmdのマテリアルには多くの違いが有ります。

    * MMDモデル(PMX)の材質（マテリアル）設定  

        | 設定             | 働き |
        | :--------------- |:---- |
        | 拡散色           | モデルの色                                                                           |
        | 非透過度         | 透過設定                                                                             |
        | 反射色           | スペキュラ(所謂ハイライト)の色                                                       |
        | 反射強度         | スペキュラの強さ                                                                     |
        | 環境色           | 指向性のない均一の環境光の色。拡散色に加算される                                     |
        | テクスチャマップ | 拡散色＋環境色の結果に乗算される画像ファイル                                         |
        | スフィアマップ   | モデルの法線に従って加算または乗算する画像ファイル<br>光の映り込みなどを擬似的に行う |
        | Toonマップ       | ライトに照らされている所と影の所の色を乗算する画像ファイル                           |

    * ray-mmdのマテリアル設定  
        各種マップにより材質の見た目を決定します。全ての設定でマップ（画像データ）が指定できます。数値を指定することもできます。  

        | 設定                               | 働き |
        | :--------------------------------- |:---- |
        | ALBEDO(アルベド)                   | モデルの色 |
        | Alpha(アルファ、透過)              | 透過設定
        | Normal（ノーマル、法線）           | ノーマルマップによりモデルの形以上に凸凹を表現できる
        | Smoothness(スムースネス、滑らかさ) | 材質そのものの滑らかさ
        | Metalness(メタルネス、メタリック)  | 金属か非金属かを指定する
        | Specular(スペキュラ)               | スペキュラの強さ
        | Occlusion(オクルージョン、閉塞)    | アンビエントオクルージョンの表現に使用
        | Parallax(パララックス、視差)       | 視差マッピング。ノーマルマップ、ハイトマップとの併用し描画するピクセルをずらすことによって、より立体感を表現する。ディスプレイスメントマッピングではない。
        | Emissive(エミッシブ)               | 発光表現。ライトそのものではなく発光しているように見えるだけです

        追加設定として、`Shading Model ID`によるシェーディング方法の選択ができます。
-->

* ## マテリアルファイルの使い方

    マテリアルファイル（ `material_2.0.fx` 等）を「MaterialMap」タブで材質に割り当てることで質感を設定していきます。  
    ※ マテリアルを設定する前に、「4_1_クイックスタート」でモデルの「Main」タブに `main.fx` を割り当てたように、全てのモデルには「Main」タブに `main.fx` を割り当てなければなりません。  

    1. モデルの「Main」タブに `main.fx` を割り当てる。（「MaterialMap」タブに `Materials\material_2.0.fx` がデフォルトマテリアルとして割り当てられます。）
    2. 「MaterialMap」タブを選択し、モデルを選んでマウスの右クリックで「サブセット展開」を選択します。
    3. 希望する材質にマテリアルファイルをドラッグ・アンド・ドロップ、または、ダブルクリックで表示されるファイルダイアログから選択し、設定します。  
        この時、「MaterialMap」タブで材質のチェックをオフにすると、MMDでの表示が消えるので希望する材質を見つけやすいかもしれません。
    4. 「OK」ボタンを押して割り当てを終了します。

* ## マテリアル(Materials)フォルダ一覧  

    ray-mmdには多くのプリセット（と言うよりはサンプル）マテリアルが有ります。ここではフォルダごとにどのようなマテリアルファイルが有るか見ていきます。

    * ### ルートフォルダ  
        デフォルトのマテリアルファイルとreadmeが有ります。
    
        | ファイル名                | 説明             |
        | :------------------------ | :--------------- |
        | material_2.0.fx           | デフォルトのマテリアル設定ファイル。<br>「Main」タブに`main.fx`を割り当てた時に、「MaterialMap」タブに自動的に割り当てられる。
        | material_common_2.0.fxsub | マテリアルのコード。<br>各マテリアル設定ファイルから読み込まれ実行される。
        | material_skybox.fx        | スカイボックス用のマテリアル設定ファイル。
        | `README.md`               | マテリアルの各パラメータについて書かれたファイル。（英語）<br>日本語に意訳したものは、`8_2_マテリアル_パラメータ`を参照してください。
        | README_chs.md             | マテリアルの各パラメータについて書かれたファイル。（中国語）

    * `material_2.0.fx` を割り当てたシェーダーボール

        [![8_1_material_def](images/8_1_material_def.png)](images/8_1_material_def.png)


    * ### _MaterialMap  
        プリセットマテリアルで使用される各種マップが有ります。

    * ### ClearCoat  
        金属・非金属の材質に関わらず透明な層を持つ材質を模したマテリアル。例えば、車のボディなど。  
        Shading Model ID の Clear Coat(=6) を使用したサンプルマテリアル。  

        | material_albedo.fx | material_black.fx |
        | :-----------------: | :---------------: |
        | [![8_1_ClearCoat_albedo](images/8_1_ClearCoat_albedo.png)](images/8_1_ClearCoat_albedo.png) | [![8_1_ClearCoat_black](images/8_1_ClearCoat_black.png)](images/8_1_ClearCoat_black.png) |

        | material_metal_clearcoat.fx | material_white.fx |
        | :-----------------: | :---------------: |
        | [![8_1_ClearCoat_metal](images/8_1_ClearCoat_metal.png)](images/8_1_ClearCoat_metal.png) | [![8_1_ClearCoat_white](images/8_1_ClearCoat_white.png)](images/8_1_ClearCoat_white.png) |

    * ### Cloth  
        布を模したマテリアル。マイクロファセットによる表面の細かな凸凹によるざらつきを再現しています。詳細は[ペーパー](http://blog.selfshadow.com/publications/s2017-shading-course/imageworks/s2017_pbs_imageworks_sheen.pdf)(PDF)を参照してください。  
        Shading Model ID の Cloth(=5) を使用したサンプルマテリアル。  


        | material_black_coat.fx | material_cloth.fx | material_white.fx |
        | :---------------------: | :----------------: | :----------------: |
        | [![8_1_Cloth_black_coat](images/8_1_Cloth_black_coat.png)](images/8_1_Cloth_black_coat.png) | [![8_1_Cloth_albedo](images/8_1_Cloth_albedo.png)](images/8_1_Cloth_albedo.png) | [![8_1_Cloth_white](images/8_1_Cloth_white.png)](images/8_1_Cloth_white.png) |

    * ### Editor
        コントローラーを使用して、マテリアルの値を変更することが出来ます。

        * 使い方  
            1. `Editor`フォルダ内の任意のfxをモデルに割り当てます。
            2. 同じフォルダにある同じ番号の`PMX`をMMDに追加します。（これがコントローラーになります。）
            3. コントローラーのモーフを操作してマテリアルの設定を行います。

        * Tips:  
            コントローラーを調整する時は、「表示」メニューの「モデル編集時カメラ・照明追従」をオンにし、ボーン操作パネルの「選択」ボタンをオフ（ショートカット：Cキー）にしておくと調整がやりやすいと思います。  

        * コントローラーの説明
            * ### 表情操作パネル 左上  
                Albedo,Specular,Emissiveの色やマップの繰り返し回数等を設定します。HSVで設定するものはSの設定を上げておかないと変化がわかりづらいかもしれません。  

                | モーフ名          | 機能    |
                | :---              | :---    |
                | AlbedoH<br>AlbedoS<br>AlbedoV | AlbedoのH(色相)S(彩度)V(明度)を調整します。 |
                | AlbedoLoops       | Albedoに設定しているマップの繰り返し回数を設定します。 |
                | SpecularH<br>SpecularS<br>SpecularV+<br>SpecularV- | SpecularのH(色相)S(彩度)V(明度)を調整します。 |
                | SpecularLoops     | Specularに設定しているマップの繰り返し回数を設定します。 |
                | EmissiveR         | EmissiveのカラーをRGBで調整します。 |
                | EmissiveBlink     | Emissiveの点滅速度を調整します。<BR>割り当てたfxファイルの`EMISSIVE_MAP_APPLY_BLINK`に`1`が設定されていないと機能しません。 |
                | EmissiveIntensity | Emissiveの輝度を調整します。 |
                | EmissiveLoops     | Emissiveに設定しているマップの繰り返し回数を設定します。 |

            * ### 表情操作パネル 右上  
                ノーマルマップの設定を行います。ノーマルマップが設定されていないと機能しません。  

                | モーフ名          | 機能    |
                | :---              | :---    |
                | NormalScale+<br>NormalScale- | Normalの凸凹感を調整します。 |
                | NormalLoops       | Normalに設定しているマップの繰り返し回数を設定します。 |
                | NormalSubScale+<br>NormalSubScale- | NormalSubの凸凹感を調整します。 |
                | NormalSubLoops    | NormalSubに設定しているマップの繰り返し回数を設定します。 |

            * ### 表情操作パネル 右下  
                Smoothness,Metalness,Melaninの設定を行います。  

                | モーフ名          | 機能    |
                | :---              | :---    |
                | Smoothness        | Smoothnessを調整します。 |
                | SmoothnessLoops   | Smoothnessに設定しているマップの繰り返し回数を設定します。 |
                | Metalness         | Metalnessを調整します。 |
                | MetalnessLoops    | Metalnessに設定しているマップの繰り返し回数を設定します。 |
                | Melanin           | Melaninを調整します。 |
                | MelaninLoops      | Melaninに設定しているマップの繰り返し回数を設定します。 |

            * ### 表情操作パネル 左下  
                Shading Model ID 用の設定を行います。Shading Model ID が 1 以上でないと機能しません。  
                また、Shading Model IDによってCustomA、CustomBのパラメータの意味が変わります。詳細は「8_2_マテリアル_パラメータ」を参照してください。  

                | モーフ名          | 機能    |
                | :---              | :---    |
                | CustomA           |        |
                | CustomALoops      | CustomAに設定しているマップの繰り返し回数を設定します。 |
                | Custom2R<br>Custom2G<br>Custom2B |        |
                | CustomBLoops      | CustomBに設定しているマップの繰り返し回数を設定します。 |

    * ### Emissive
        発光体表現を行うマテリアル。光を投射するわけではないので、他のモデルを照らしたり、影ができるようなことはありません。（AutoLuminanceのようなものと言えばわかりやすいですかね？）

        | フォルダ名 | 説明 |
        | :--------- | :--- |
        | material_lighting.fx | これはライトを追加した時に、自動的にそのライトの「MaterialMap」タブに割り当てられます。（ライト用）|
        | Fixed Color x1～x4 | アルベドまたは固定色で発光して見えるマテリアル。x1,x2,x4は `emissiveIntensity` で輝度を変えたもの。 |
        | Fixed Color Blink x1～x4 | Fixed Color x1～x4に点滅設定を追加したもの。 |
        | Rainbow | Emmisiveに設定する色にアニメーションGIFを使用して、色が変化するマテリアル |
        | BodyLine | Rainbow同様アニメーションGIFを使用して、発光する部分を制御しているマテリアル |

        | material_albedo_x2.fx | material_blue_x2.fx | material_green_x2.fx |
        | :-------------------: | :-----------------: | :------------------: |
        | [![8_1_Emissive_x2_albedo](images/8_1_Emissive_x2_albedo.png)](images/8_1_Emissive_x2_albedo.png) | [![8_1_Emissive_x2_blue](images/8_1_Emissive_x2_blue.png)](images/8_1_Emissive_x2_blue.png) | [![8_1_Emissive_x2_green](images/8_1_Emissive_x2_green.png)](images/8_1_Emissive_x2_green.png) |

        | material_orange_x2.fx | material_purple_x2.fx | material_red_x2.fx |
        | :-------------------: | :-----------------: | :------------------: |
        | [![8_1_Emissive_x2_orange](images/8_1_Emissive_x2_orange.png)](images/8_1_Emissive_x2_orange.png) | [![8_1_Emissive_x2_purple](images/8_1_Emissive_x2_purple.png)](images/8_1_Emissive_x2_purple.png) | [![8_1_Emissive_x2_red](images/8_1_Emissive_x2_red.png)](images/8_1_Emissive_x2_red.png) |

        | material_white_blue_x2.fx | material_white_pink_x2.fx | material_white_x2.fx |
        | :-------------------: | :-----------------: | :------------------: |
        | [![8_1_Emissive_x2_white_blue](images/8_1_Emissive_x2_white_blue.png)](images/8_1_Emissive_x2_white_blue.png) | [![8_1_Emissive_x2_white_pink](images/8_1_Emissive_x2_white_pink.png)](images/8_1_Emissive_x2_white_pink.png) | [![8_1_Emissive_x2_white](images/8_1_Emissive_x2_white.png)](images/8_1_Emissive_x2_white.png) |

        | material_yellow_green_x2.fx | material_yellow_x2.fx |
        | :-------------------: | :-----------------: |
        | [![8_1_Emissive_x2_yellow_green](images/8_1_Emissive_x2_yellow_green.png)](images/8_1_Emissive_x2_yellow_green.png) | [![8_1_Emissive_x2_yellow](images/8_1_Emissive_x2_yellow.png)](images/8_1_Emissive_x2_yellow.png) |

    * ### Hair
        髪の毛向けのマテリアル。  
        主にスペキュラの乗りが変わっています。  
        *_anisotropy.fxは、Shading Model ID の Anisotropy(=3) を使用したサンプルマテリアル。

        | material_2.0.fx<br>黒いモデルを使用 | material_hair.fx | material_hair_sss.fx |
        | :-------------------: | :-----------------: | :------------------: |
        | [![8_1_material_def_black](images/8_1_material_def_black.png)](images/8_1_material_def_black.png) | [![8_1_hair](images/8_1_hair.png)](images/8_1_hair.png) | [![8_1_hair_sss](images/8_1_hair_sss.png)](images/8_1_hair_sss.png) |

        | material_hair_with_anisotropy.fx | material_hair_with_anisotropy2.fx |
        | :-------------------: | :-----------------: |
        | [![8_1_hair_with_anisotropy](images/8_1_hair_with_anisotropy.png)](images/8_1_hair_with_anisotropy.png) | [![8_1_hair_with_anisotropy2](images/8_1_hair_with_anisotropy2.png)](images/8_1_hair_with_anisotropy2.png) |

    * ### Metallic
        金属のマテリアル。  
        金属のマテリアルの設定は、アルベドに金属の種類に応じたF0（光が垂直に入射するときのフレネル反射率 F(0°)）が設定されます。この値は現実世界での測定に基づいた値です。

        * ### Flat ingot rough  
            表面がざらついた金属（ `Smoothness` の値が低い）  
            ※ *_meatal.fxは `Albedo` にモデルのテクスチャを使い、その他はテクスチャではなく `const float3 albedo` に、F0（光が垂直に入射するときのフレネル反射率 F(0°)）が設定されています。  

            | material_rough_brass.fx | material_rough_copper.fx | material_rough_gold.fx |
            | :-------------------: | :-----------------: | :------------------: |
            | [![8_1_Metallic_rough_brass](images/8_1_Metallic_rough_brass.png)](images/8_1_Metallic_rough_brass.png) | [![8_1_Metallic_rough_copper](images/8_1_Metallic_rough_copper.png)](images/8_1_Metallic_rough_copper.png) | [![8_1_Metallic_rough_gold](images/8_1_Metallic_rough_gold.png)](images/8_1_Metallic_rough_gold.png) |

            | material_rough_iron.fx | material_rough_metal.fx | material_rough_silver.fx |
            | :-------------------: | :-----------------: | :------------------: |
            | [![8_1_Metallic_rough_iron](images/8_1_Metallic_rough_iron.png)](images/8_1_Metallic_rough_iron.png) | [![8_1_Metallic_rough_metal](images/8_1_Metallic_rough_metal.png)](images/8_1_Metallic_rough_metal.png) | [![8_1_Metallic_rough_silver](images/8_1_Metallic_rough_silver.png)](images/8_1_Metallic_rough_silver.png) |

        * ### Flat ingot smooth
            表面が滑らかな金属（ `Smoothness` の値が高い）  
            ※ *_meatal.fxは `Albedo` にモデルのテクスチャを使い、その他はテクスチャではなく `const float3 albedo` に、F0（光が垂直に入射するときのフレネル反射率 F(0°)）が設定されています。  

            | material_smooth_brass.fx | material_smooth_copper.fx | material_smooth_gold.fx |
            | :-------------------: | :-----------------: | :------------------: |
            | [![8_1_Metallic_smooth_brass](images/8_1_Metallic_smooth_brass.png)](images/8_1_Metallic_smooth_brass.png) | [![8_1_Metallic_smooth_copper](images/8_1_Metallic_smooth_copper.png)](images/8_1_Metallic_smooth_copper.png) | [![8_1_Metallic_smooth_gold](images/8_1_Metallic_smooth_gold.png)](images/8_1_Metallic_smooth_gold.png) |

            | material_smooth_iron.fx | material_smooth_metal.fx | material_smooth_silver.fx |
            | :-------------------: | :-----------------: | :------------------: |
            | [![8_1_Metallic_smooth_iron](images/8_1_Metallic_smooth_iron.png)](images/8_1_Metallic_smooth_iron.png) | [![8_1_Metallic_smooth_metal](images/8_1_Metallic_smooth_metal.png)](images/8_1_Metallic_smooth_metal.png) | [![8_1_Metallic_smooth_silver](images/8_1_Metallic_smooth_silver.png)](images/8_1_Metallic_smooth_silver.png) |

        * ### Flat ingot worn
            摩耗した金属（ `Smoothness` にマップを使用したサンプル）  
            ※ *_meatal.fxは `Albedo` にモデルのテクスチャを使い、その他はテクスチャではなく `const float3 albedo` に、F0（光が垂直に入射するときのフレネル反射率 F(0°)）が設定されています。  

            | material_worn_brass.fx | material_worn_copper.fx | material_worn_gold.fx |
            | :-------------------: | :-----------------: | :------------------: |
            | [![8_1_Metallic_worn_brass](images/8_1_Metallic_worn_brass.png)](images/8_1_Metallic_worn_brass.png) | [![8_1_Metallic_worn_copper](images/8_1_Metallic_worn_copper.png)](images/8_1_Metallic_worn_copper.png) | [![8_1_Metallic_worn_gold](images/8_1_Metallic_worn_gold.png)](images/8_1_Metallic_worn_gold.png) |

            | material_worn_iron.fx | material_worn_metal.fx | material_worn_silver.fx |
            | :-------------------: | :-----------------: | :------------------: |
            | [![8_1_Metallic_worn_iron](images/8_1_Metallic_worn_iron.png)](images/8_1_Metallic_worn_iron.png) | [![8_1_Metallic_worn_metal](images/8_1_Metallic_worn_metal.png)](images/8_1_Metallic_worn_metal.png) | [![8_1_Metallic_worn_silver](images/8_1_Metallic_worn_silver.png)](images/8_1_Metallic_worn_silver.png) |

        * ### Ingot Bricks
            レンガ状の金属（ `NORMAL_MAP_FILE`,`OCCLUSION_MAP_FILE` を使用したサンプル）  
            ※ *_meatal.fxは `Albedo` にモデルのテクスチャを使い、その他はテクスチャではなく `const float3 albedo` に、F0（光が垂直に入射するときのフレネル反射率 F(0°)）が設定されています。  

            | material_rough_brass.fx | material_rough_copper.fx | material_rough_gold.fx |
            | :-------------------: | :-----------------: | :------------------: |
            | [![8_1_Metallic_Bricks_brass](images/8_1_Metallic_Bricks_brass.png)](images/8_1_Metallic_Bricks_brass.png) | [![8_1_Metallic_Bricks_copper](images/8_1_Metallic_Bricks_copper.png)](images/8_1_Metallic_Bricks_copper.png) | [![8_1_Metallic_Bricks_gold](images/8_1_Metallic_Bricks_gold.png)](images/8_1_Metallic_Bricks_gold.png) |

            | material_rough_iron.fx | material_rough_metal.fx | material_rough_silver.fx |
            | :-------------------: | :-----------------: | :------------------: |
            | [![8_1_Metallic_Bricks_iron](images/8_1_Metallic_Bricks_iron.png)](images/8_1_Metallic_Bricks_iron.png) | [![8_1_Metallic_Bricks_metal](images/8_1_Metallic_Bricks_metal.png)](images/8_1_Metallic_Bricks_metal.png) | [![8_1_Metallic_Bricks_silver](images/8_1_Metallic_Bricks_silver.png)](images/8_1_Metallic_Bricks_silver.png) |

    * ### Programmable
        プログラムコード（`.fxsub`）が専用に作られたマテリアル。その為、設定ファイルも専用のものになっています。  
        waterは `water.pmx` を追加し `material_water.fx` を割り当てています。  

        | material_water.fx | material_wetness.fx | water+wetness |
        | :-------------------: | :-----------------: | :------------------: |
        | [![8_1_Programmable_Water](images/8_1_Programmable_Water.png)](images/8_1_Programmable_Water.png) | [![8_1_Programmable_Wetness](images/8_1_Programmable_Wetness.png)](images/8_1_Programmable_Wetness.png) | [![8_1_Programmable_Water_wetness](images/8_1_Programmable_Water_wetness.png)](images/8_1_Programmable_Water_wetness.png) |

    * ### Skin
        肌向けのマテリアル。  
        Shading Model ID の PreIntegrated Skin(=1) を使用したサンプルマテリアル。  
        サンプル画像のシェーダーボールはアルベドに使われているテクスチャが白いので、肌色に見えませんが影との境目あたりにSSSの効果が出ているのが見て取れると思います。  
        beigeのサンプルは`ALBEDO_MAP_APPLY_SCALE`に`1`を設定して、`const float3 albedo`に設定した色で乗算しています。この方法を使うと明るすぎるアルベドを調整する事ができます。（設定値によっては明るくすることも出来ます）  

        | material_body.fx | material_body_beige.fx | material_body_beige_dark.fx |
        | :-------------------: | :-----------------: | :------------------: |
        | [![8_1_Skin_body](images/8_1_Skin_body.png)](images/8_1_Skin_body.png) | [![8_1_Skin_body_beige](images/8_1_Skin_body_beige.png)](images/8_1_Skin_body_beige.png) | [![8_1_Skin_body_beige_dark](images/8_1_Skin_body_beige_dark.png)](images/8_1_Skin_body_beige_dark.png) |

        | material_skin.fx | material_skin_beige.fx | material_skin_beige_dark.fx |
        | :-------------------: | :-----------------: | :------------------: |
        | [![8_1_Skin_skin](images/8_1_Skin_skin.png)](images/8_1_Skin_skin.png) | [![8_1_Skin_skin_beige](images/8_1_Skin_skin_beige.png)](images/8_1_Skin_skin_beige.png) | [![8_1_Skin_skin_beige_dark](images/8_1_Skin_skin_beige_dark.png)](images/8_1_Skin_skin_beige_dark.png) |

        | material_skin_melanoderm.fx | Human<br>material_body.fx | Human<br>material_body_melanoderm.fx |
        | :-------------------: | :-----------------: | :------------------: |
        | [![8_1_Skin_skin_melanoderm](images/8_1_Skin_skin_melanoderm.png)](images/8_1_Skin_skin_melanoderm.png) | [![8_1_Skin_Human_body](images/8_1_Skin_Human_body.png)](images/8_1_Skin_Human_body.png) | [![8_1_Skin_Human_body_melanoderm](images/8_1_Skin_Human_body_melanoderm.png)](images/8_1_Skin_Human_body_melanoderm.png) |

    * TDAフォルダ
        「Tda式初音ミク・アペンド　Ver1.00」用に作成された、curvatureマップ、thicknessマップを使ったサンプル。  
        これらのマップを作成、使用することでSSSの効果をコントロールできます。

        | material_2.0.fx | material_TDA_face.fx<br>material_TDA_body.fx<br>肌以外はmaterial_2.0.fx | material_TDA_face_red.fx<br>material_TDA_body_red.fx<br>肌以外はmaterial_2.0.fx |
        | :-------------------: | :-----------------: | :------------------: |
        | [![8_1_Skin_TDA_WS_def](images/8_1_Skin_TDA_WS_def.png)](images/8_1_Skin_TDA_WS_def.png) | [![8_1_Skin_TDA_WS_face_body](images/8_1_Skin_TDA_WS_face_body.png)](images/8_1_Skin_TDA_WS_face_body.png) | [![8_1_Skin_TDA_WS_faceRed_bodyRed](images/8_1_Skin_TDA_WS_faceRed_bodyRed.png)](images/8_1_Skin_TDA_WS_faceRed_bodyRed.png) |

    * ### Subsurface
        サブサーフェススキャッタリング(Subsurface Scattering : SSS)を使用したマテリアル。  
        Shading Model ID の Subsurface(=7) を使用したサンプルマテリアル。  
        サブサーフェスは半透明な物体の表面を透過し、内部で散乱した後に表面から出て行く現象で、現実世界では数多くみられます。（例えば、肌、氷、牛乳、大理石、など）

        | material_jade_white.fx | material_lampshade.fx | material_marble.fx |
        | :-------------------: | :-----------------: | :------------------: |
        | [![8_1_Subsurface_jade_white](images/8_1_Subsurface_jade_white.png)](images/8_1_Subsurface_jade_white.png) | [![8_1_Subsurface_lampshade](images/8_1_Subsurface_lampshade.png)](images/8_1_Subsurface_lampshade.png) | [![8_1_Subsurface_marble](images/8_1_Subsurface_marble.png)](images/8_1_Subsurface_marble.png) |

    * ### Transparent
        透明な材質のマテリアル。
        Shading Model ID の Glass(=4) を使用したサンプルマテリアル。  
        透明度自体は `alpha` で設定します。  
        CUSTOM_Aの設定で曲率、CUSTOM_Bの設定でガラスを通過する色（ライトの反対側、影の部分に現れる色）を設定します。

        | material_glass.fx | material_glass_metal.fx | material_glass.fx を改変|
        | :-------------------: | :-----------------: |:-----------------: |
        | [![8_1_Transparent_glass](images/8_1_Transparent_glass.png)](images/8_1_Transparent_glass.png) | [![8_1_Transparent_glass_metal](images/8_1_Transparent_glass_metal.png)](images/8_1_Transparent_glass_metal.png) | [![8_1_Transparent_glass_mod](images/8_1_Transparent_glass_mod.png)](images/8_1_Transparent_glass_mod.png) |

    * ### Video
        MMDのスクリーンやアニメーションGIFなどの表示を行うマテリアル。  
        このマテリアルを使う場合、`Extension\DummyScreen\DummyScreen.x` をMMDに追加し、MMDの「背景」メーニューで「ON・モード～」を選択する必要があります。

        | material_screen.fx | material_screen_emissive.fx | material_screen_led.fx |
        | :-------------------: | :-----------------: | :------------------: |
        | [![8_1_Video_screen](images/8_1_Video_screen.png)](images/8_1_Video_screen.png) | [![8_1_Video_screen_emissive](images/8_1_Video_screen_emissive.png)](images/8_1_Video_screen_emissive.png) | [![8_1_Video_screen_led](images/8_1_Video_screen_led.png)](images/8_1_Video_screen_led.png) |

        ※ サンプル画像は床にマテリアルを設定しています。

* ## TIPS
    モデルをサブセット展開して材質ごとに割り当てた「MaterialMap」タブの設定は保存、読み込みができます。  
    設定を保存しておくことで、別のシーンで同じモデルを使う時にマテリアル割り当ての時間を短縮することが出来ます。  

    * 設定の保存方法  
        1. MMEの「エフェクト割り当て」ダイアログを開きます。
        2. 「エフェクト割り当て」ダイアログで「MaterialMap」タブを選択。
        3. 設定を保存したいモデルを選択。
        4. 「エフェクト割り当て」ダイアログのファイルメニューから、「モデル単位で設定保存」を選択して、ファイル名を設定して保存します。（拡張子は`.emd`で中身はテキストエディタで見ることが出来ます。）

    * 設定の保存方法  
        1. MMEの「エフェクト割り当て」ダイアログを開きます。
        2. 「エフェクト割り当て」ダイアログで「MaterialMap」タブを選択。（**選択したタブに読み込むので、間違えないように！**）
        3. 設定を保存したいモデルを選択。
        4. 「エフェクト割り当て」ダイアログのファイルメニューから、「モデル単位で設定読込」を選択して、ファイル名を指定して読み込みます。

-----

<small> Model : ShaderBall_MMD by カユテガ / Tda式初音ミク・アペンド　Ver1.00 by Tda  
 Pose : 女の子の撮影ポーズ集 by KEITEL</small>